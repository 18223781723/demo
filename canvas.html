<!-- <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>图片压缩</title>
</head>

<body>
    <input type="file" id="file" accept="image/*">
    <img id="img" src="" alt="" width="375" height="375">
    <canvas id="canvas" width="375" height="300"></canvas>
</body>
<script>
    var canvas = document.getElementById('canvas');
    var ele = document.getElementById('file');
    var image = document.getElementById('img');
    var file;
    var url;
    var reader = new FileReader();
    ele.onchange = function (res) {
        file = this.files[0]
        reader.readAsDataURL(file);
        console.log(file)
    }

    reader.onload = function (res) {
        url = res.target.result
        image.src = res.target.result
        console.log(res)
    }
    image.onload = function () {
        var ctx = canvas.getContext('2d');
        ctx.drawImage(image, 0, 0, 300, 300);
        var newUrl = canvas.toDataURL('image/jpg', 0.8);
        // canvas.toBlob(function(res){
        //     console.log(res)
        // })
        console.log(newUrl)
    }
    //var img = "http://yebaotest.sideltd.cn/img.jpg";//imgurl 就是你的图片路径  

</script>

</html> -->
<!-- <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>js 图片转base64方式</title>
</head>

<body>
    <p id="container2"></p>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script>
        let imgSrc = "https://z649319834.github.io/Learn_Example/video_track/webvtt.jpg";
        function getBase64Image() {
            var canvas = document.createElement("canvas");
            var p = document.getElementById('container2')
            canvas.width = 375;
            canvas.height = 375;
            var ctx = canvas.getContext("2d");
            var image = new Image();
            //至关重要
            image.crossOrigin = '';
            image.src = imgSrc;
            image.onload = function () {
                ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
                var dataURL = canvas.toDataURL();
                console.log(dataURL);
                p.innerHTML = '<img src="'+dataURL+'">'
            }
        }
        getBase64Image()
    </script>
</body>

</html> -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <canvas id="canvas"></canvas>
    <img src="images/bird2.png" alt="" id="img" style="display:none;">
    <img id="canvasImg" />
    <script>
        var img = document.getElementById("img");
        //img.setAttribute('crossOrigin', 'anonymous');
        //img.src = img.src + '?time=' + new Date().getTime();
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext('2d');
        img.onload = function () {
            canvas.width = 375;
            canvas.height = 375;
            ctx.drawImage(img, 0, 0,300,300);
            document.getElementById('canvasImg').src = canvas.toDataURL("image/jpeg", 1);
        }
		// 谷歌启动项配置参数--allow-file-access-from-files解决报错（跨域引起）
    </script>
</body>

</html>